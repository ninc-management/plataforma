<div class="header-container">
  <div class="logo-container" [ngStyle]="{ 'margin-top.px': isPhone() ? 0 : -7 }">
    <a
      class="sidebar-toggle hamburger hamburger--collapse"
      cursor="pointer"
      matRipple
      [ngClass]="{ 'is-active': menuButtonClicked }"
      [matRippleUnbounded]="false"
      [matRippleCentered]="true"
      [matRippleRadius]="20"
      (click)="toggleSidebar()"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </a>
    <a
      class="logo"
      href="#"
      (click)="navigateHome()"
      matRipple
      [matRippleUnbounded]="false"
      [matRippleCentered]="false"
      style="height: 42px; display: flex; border-radius: 0.17rem; align-items: center"
    >
      <nb-icon class="logoIcon" [icon]="logoIcon" pack="fac" *ngIf="!isPhone()"></nb-icon>
      <span *ngIf="config.socialConfig.showCompanyName">{{ menuTitle }}</span>
    </a>
  </div>
</div>

<div class="header-container" *ngIf="env.demo != undefined">
  <h2>VERSÃO DE HOMOLOGAÇÃO</h2>
</div>

<div class="header-container">
  <nb-actions size="small">
    <!-- <nb-action class="control-item">
      <nb-search
        type="rotate-layout"
        matRipple
        [matRippleUnbounded]="true"
        [matRippleCentered]="true"
        [matRippleRadius]="20"
      ></nb-search
    ></nb-action>
    <nb-action
      class="control-item"
      icon="email-outline"
      matRipple
      [matRippleUnbounded]="true"
      [matRippleCentered]="true"
      [matRippleRadius]="20"
    ></nb-action> -->
    <nb-action
      class="control-item"
      [@shake]="state"
      (@shake.done)="onDone($event)"
      [icon]="user.notifications.length ? 'bell' : 'bell-outline'"
      [badgeText]="user.notifications.length ? user.notifications.length.toString() : ''"
      badgeStatus="danger"
      [nbPopover]="notificationBox"
      nbPopoverPlacement="bottom"
      [nbPopoverTrigger]="user.notifications.length ? 'click' : 'noop'"
      matRipple
      [matRippleUnbounded]="true"
      [matRippleCentered]="true"
      [matRippleRadius]="20"
    ></nb-action>
    <ng-template #notificationBox>
      <nb-card class="nb-card-notification">
        <nb-card-header style="text-align: left">Notificações</nb-card-header>
        <div class="notification-list">
          <nb-list-item
            style="display: block"
            *ngFor="let notification of user.notifications.reverse(); let i = index; trackBy: trackByIndex"
            (click)="openNotification(i, notification)"
          >
            <nb-user
              [name]="
                [notification.from, userService.idToUser.bind(userService), 'fullName'] | transformPipe: idToProperty
              "
              [title]="notification.title"
              [picture]="
                [notification.from, userService.idToUser.bind(userService), 'profilePicture']
                  | transformPipe: idToProperty
              "
            ></nb-user>
            <div class="notification">
              <pre [innerHTML]="[notification.message] | transformPipe: stringUtils.applyBoldToMention"></pre>
              <span style="float: right">
                {{ [notification.created] | transformPipe: elapsedTime.bind(this) }}
              </span>
            </div>
          </nb-list-item>
        </div>
      </nb-card>
    </ng-template>
    <nb-action
      class="logout-action"
      [icon]="{ icon: 'log-out', pack: 'ion' }"
      link="/auth/logout"
      matRipple
      [matRippleUnbounded]="true"
      [matRippleCentered]="true"
      [matRippleRadius]="20"
    ></nb-action>
    <nb-action
    *ngIf="!isPhone()"
      class="slack-action"
      [icon]="{ icon: 'slack', pack: 'fac' }"
      matRipple
      (click)="displayIframe()"
      [matRippleUnbounded]="true"
      [matRippleCentered]="true"
      [matRippleRadius]="20"
    ></nb-action>
  </nb-actions>
  <iframe
    title="Janela de comunicação"
    class="slackWidget"
    src="https://nortanengenharia.slack.com"
    #widget
  ></iframe>
</div>
