<div class="container-fluid p-0">
  <div class="row">
    <div class="col-12 my-3">
      <nb-progress-bar
        [status]="getPercentualProgress() == 100 ? 'success' : 'primary'"
        [size]="'tiny'"
        [displayValue]="true"
        [value]="getPercentualProgress()"
      ></nb-progress-bar>
    </div>
  </div>
  <form (ngSubmit)="updateContractManagement()" #form="ngForm" aria-labelledby="title">
    <div class="row">
      <div class="col-4">
        <div class="form-control-group">
          <label class="label" for="contract-code">Código do Contrato:</label>
          <input nbInput [ngModel]="contract.code" name="contract-code" fullWidth fieldSize="large" [readonly]="true" />
        </div>
      </div>
      <div class="col-5">
        <div class="form-control-group">
          <label class="label" for="contractor">Cliente:</label>
          <input
            nbInput
            [ngModel]="contract.contractor"
            name="contractor"
            fullWidth
            fieldSize="large"
            [nbTooltip]="tooltipText()"
            nbTooltipPlacement="top"
            nbTooltipStatus="primary"
            [readonly]="true"
          />
        </div>
      </div>
      <div class="col-3">
        <div class="form-control-group">
          <label class="label" for="model">Modelo:</label>
          <!-- Aguardar o Augusto terminar o novo completer -->
          <input nbInput name="model" placeholder="Modelo" fullWidth fieldSize="large" [readonly]="true" />
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-2">
        <div class="form-control-group">
          <label class="label" for="start-date">Início:</label>
          <input
            nbInput
            [ngModel]="utils.formatDate(contract.created)"
            name="start-date"
            fullWidth
            fieldSize="large"
            [readonly]="true"
          />
        </div>
      </div>
      <div class="col-2">
        <div class="form-control-group">
          <label class="label" for="end-date">Fim:</label>
          <input
            nbInput
            [ngModel]="deadline ? utils.formatDate(deadline) : ''"
            name="end-date"
            fullWidth
            fieldSize="large"
            [readonly]="true"
          />
        </div>
      </div>
      <div class="col-2">
        <div class="form-control-group">
          <label class="label" for="remaining-days">Dias restantes:</label>
          <input
            nbInput
            [ngModel]="getRemainingDays()"
            name="remaining-days"
            fullWidth
            fieldSize="large"
            [readonly]="true"
          />
        </div>
      </div>
      <div class="col-3">
        <div class="form-control-group">
          <label class="label" for="responsible">Responsável:</label>
          <input nbInput [ngModel]="responsible" name="responsible" fullWidth fieldSize="large" [readonly]="true" />
        </div>
      </div>
      <div class="col-3">
        <div class="form-control-group">
          <label class="label" for="management-status">Status de gestão:</label>
          <nb-select
            [(ngModel)]="contract.managementStatus"
            #managementStatus="ngModel"
            id="management-status"
            name="management-status"
            placeholder="Selecione o status da gestão"
            fullWidth
            size="large"
            [status]="managementStatus.dirty ? (managementStatus.invalid ? 'danger' : 'success') : 'basic'"
            [attr.aria-invalid]="managementStatus.invalid && managementStatus.touched ? true : null"
          >
            <nb-option *ngFor="let status of avaliableStatus" [value]="status">
              {{ status }}
            </nb-option>
          </nb-select>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <div class="form-control-group">
          <label class="label" for="management-notes">Observações:</label>
          <textarea
            nbInput
            [(ngModel)]="contract.managementNotes"
            id="management-notes"
            name="management-notes"
            fullWidth
            fieldSize="large"
          ></textarea>
        </div>
      </div>
    </div>
    <ngx-checklist [contract]="contract"></ngx-checklist>
    <div class="row">
      <div class="col-12">
        <button nbButton fullWidth status="primary" size="large" [disabled]="!form.valid || !form.dirty">
          Atualizar
        </button>
      </div>
    </div>
  </form>
</div>
